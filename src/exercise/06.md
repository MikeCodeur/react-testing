# mocker l'API du navigateur

### üí° mocker l'API du navigateur

## üìù Tes notes

Detaille ce que tu as appris ici
`src/exercise/06.md`ou¬†sur¬†une¬†page¬†[Notion](https://go.mikecodeur.com/course-notes-template)

## Comprendre

Nous √©crivons du code qui est pr√©vu pour s'ex√©cuter sur un navigateur, avec des
API bien particuli√®res comme par exemple, la gestion du localstorage, des
cookies, de la g√©olocalisation ou du syst√®me de notifications. Mais lorsque nous
ex√©cution nos tests avec jest il sont executer dans Node (avec une simulation du
navigateur [JSDOM](https://github.com/jsdom/jsdom)) et malheureusement tout
n'est pas pris en charge. c'est √©cris dans la page de JSDOM. heureusement nous
pouvons `mocker` ces impl√©mentations manquantes avec `jest.fn()` et
`mockImplementation`. Par exemple pour la g√©olocalisation.

```jsx
beforeAll(() => {
  window.navigator.geolocation = {
    getCurrentPosition: jest.fn(),
  }
})

window.navigator.geolocation.getCurrentPosition.mockImplementation(() => {
  return {
    coords: {
      latitude: 10,
      longitude: 235,
    },
  }
})
```

## Exercice

Dans cet exercice nous avons le composant `LoginSubmitNotification`, qui en plus
de se connecter demande une autorisation pour envoyer des notifications via

```jsx
window.Notification.requestPermission()
//...

new Notification(`bonjour ${name}`)
```

Ceci n'est pas disponible dans Jsdom nous allons donc le simuler avec jest. Tu
vas devoir rediger 2 tests.

- Un test qui simule un permission '`granted`' et v√©rifie le message _'Les
  notifications sont autoris√©s'_
- Un test qui simule un permission '`denied`' et v√©rifie le message _'veuillez
  autoriser les notifications'_

## üêú Feedback

Remplir le formulaire le
[formulaire de FeedBack](https://go.mikecodeur.com/cours-react-avis).
