# Test de formulaires

### ğŸ’¡ Test de formulaires

## ğŸ“ Tes notes

Detaille ce que tu as appris ici
`src/exercise/04.md`ouÂ surÂ uneÂ pageÂ [Notion](https://go.mikecodeur.com/course-notes-template)

## Comprendre

nous allons maintenant tester un formulaire de connexion avec login mot de passe

```jsx
function LoginForm({onSubmit}) {
  const [username, setUsername] = React.useState('')
  const [password, setPassword] = React.useState('')
  const handleSubmit = e => {
    e.preventDefault()

    onSubmit({username, password})
  }
  return (
    <form onSubmit={handleSubmit}>
      <label htmlFor="username">Nom d'utilisateur :</label>
      <input
        id="username"
        name="username"
        type="text"
        value={username}
        onChange={e => setUsername(e.target.value)}
      />

      <label htmlFor="password">Mot de passe :</label>
      <input
        id="password"
        name="password"
        type="text"
        value={password}
        onChange={e => setPassword(e.target.value)}
      />

      <div>
        <input type="submit" value={'Connexion'} />
      </div>
    </form>
  )
}
```

Nous allons rÃ©cupÃ©rer les Ã©lÃ©ment `input` qui ont le `role textbox` avec

```jsx
const usernameElement = screen.getByRole('textbox', {
  name: /Nom d'utilisateur :/i,
})
```

Pour changer une valeur via un Ã©vÃ¨nement il suffit de faire

```jsx
fireEvent.change(usernameElement, {target: {value: username}})
```

## Exercice

Dans cet exercice tu vas devoir simuler la saisie d'un `login/pass`. Lors du
clique sur le boutton `connexion` (submit) il faudra s'assurer que le bon
login/pass est passÃ© Ã  `onSubmit`

## Bonus

### 1. ğŸš€ Utilisation de userEvent

Reproduis le mÃªme test avec `userEvent`. en utilisant `getByText` `getByRole`
pour le button, `userEvent.type` pour la saisie de donnÃ©es et `userEvent.click`

```jsx
import userEvent from '@testing-library/user-event'
```

### 2. ğŸš€ Utilisation d'un fonction Mock de Jest

PlutÃ´t que de crÃ©er des fonctions et vÃ©rifier le resultat. Jest propose de
"mocker" les fonctions avec

```jsx
const handleMockFunction = jest.fn()
```

On peut ensuite faire des assertions sur ces fonctions.

```jsx
expect(handleMockFunction).toHaveBeenCalled() // la fonction a bien Ã©tÃ© appelÃ©
expect(handleMockFunction).toHaveBeenCalledTimes(1) // la fonction a bien Ã©tÃ© appelÃ© 1x
expect(handleSubmit).toHaveBeenCalledWith(arg1) //la fonction a Ã©tÃ© appeler avec arg1
```

ğŸ“‘ Documentation de
[Jest Mock Functions](https://jestjs.io/docs/mock-function-api)

ğŸ“‘ Documentation de
[toHaveBeenCalled](https://jestjs.io/docs/expect#tohavebeencalled)

ğŸ“‘ Documentation de
[toHaveBeenCalledTimes](https://jestjs.io/docs/expect#tohavebeencalledtimesnumber)

ğŸ“‘ Documentation de
[toHaveBeenCalledWith](https://jestjs.io/docs/expect#tohavebeencalledwitharg1-arg2-)

Dans cet exercice tu vas devoir supprimer la fonction `handleSubmit` est la
remplacer par une mock function jest. on veut ensuite tester ces 3 cas :

- La fonction Ã  bien Ã©tÃ© appeler
- La fonction a bien Ã©tÃ© appeler avec `username` et `password`
- La fonction a bien Ã©tÃ© appelÃ©e 1 fois

### 3. ğŸš€ DonnÃ©es de tests

On peut parfois passer du temps pour trouver des donnÃ©es pour nos tests. Par
exemple des nom d'utilisateur, des emails, des numÃ©ro de tÃ©lÃ©phones formattÃ©
correctement etc .. Pour simuler des donnÃ©es utilisateur plus facilement il
exste des lilbrairies comme

- [Chancejs](https://github.com/chancejs/chancejs)
- [FakeDataGenerator](https://github.com/Cambalab/fake-data-generator)
- [Json Schema faker](https://github.com/json-schema-faker/json-schema-faker)
- [SinonJs](https://sinonjs.org/)

[FakerJS](https://github.com/marak/Faker.js/) est trÃ¨s populaire, nous allons
l'utiliser pour gÃ©nÃ©rer des donnÃ©es de tests. Dans cet exercice tu vas devoir
utiliser Faker pour gÃ©nÃ©rer un login/pass

## Aller plus loin

ğŸ“‘ Le lien vers la doc
[https://www.w3schools.com/html/html_css.asp](https://www.w3schools.com/html/html_css.asp)

## ğŸœ Feedback

Remplir le formulaire le
[formulaire de FeedBack.](https://go.mikecodeur.com/cours-react-avis?entry.1430994900=React%20Testing%20Module&entry.533578441=04%20Test%20de%20formulaires)
